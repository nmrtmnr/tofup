import{S as T}from"./settings.js";const R=async m=>{let p=m.querySelectorAll(".text > span");Array.prototype.shuffle=function(){for(var t=this.length;t;){var o=Math.floor(Math.random()*t),a=this[--t];this[t]=this[o],this[o]=a}return this};let f=[];p.forEach((t,o)=>{f.push(o)}),f.shuffle(),p.forEach((t,o)=>{setTimeout(function(){t.classList.add("is-disp"),t.classList.add("is-blink"),setTimeout(function(){t.classList.remove("is-blink"),setTimeout(function(){t.classList.add("is-glitch")},800)},800)},180*f[o])});const l=m.querySelector("canvas"),n=l.getContext("2d"),B=T.path.asset+T.path.audio+"/breakbot/mystery/mix.mp3",u=new(window.AudioContext||window.webkitAudioContext),r=u.createAnalyser();let y=new XMLHttpRequest;const w=980;let s=window.innerWidth,i=window.innerHeight,A=Date.now(),E=Math.random()*800,c,g=!1;const d=[["#000000","#000000"],["#A64E57","#529AA8"],["#23A7F3","#F1EADC"],["#A4C27B","#284C50"],["#E21E4F","#F4CB06"],["#72ECE5","#F40F0D"],["#F5F5F5","#EA6B5F"],["#EDFD1F","#1291C6"],["#002876","#FFD30A"],["#F6E7CD","#B5978E"],["#1ECADD","#DA9CA5"],["#2B3342","#9E9570"]];c=d[0];const L=function(){C(),F(),b(),document.addEventListener("resize",()=>{F()}),document.addEventListener("click",()=>{player.fetch().then(()=>{player.play()})})},b=function(){r.fft_size=w,r.connect(u.destination),k()},k=function(){const t=new XMLHttpRequest;t.open("GET",B,!0),t.responseType="arraybuffer",t.onload=function(){u.decodeAudioData(t.response,function(o){y=o,q()})},t.send()},q=function(){const t=u.createBufferSource();t.buffer=y,t.connect(r),t.loop=!0,t.start(0)},z=function(){let t=new Uint8Array(r.frequencyBinCount),o=0,a=1,D=Date.now(),W=D-A,h=.609,M=0,S=256;r.getByteTimeDomainData(t),o=r.frequencyBinCount;for(let e=0;e<o;e++)M<t[e]&&(M=t[e]),S>t[e]&&(S=t[e]);if(Math.random()<.01){const e=Math.random()*.1+.3;Math.random()<.5?h-=e:h+=e}W>E&&(Math.random()<.85?c=d[0]:c=d[Math.floor(Math.random()*d.length)],E=Math.random()*800,A=D),n.fillStyle=c[0],n.rect(0,0,s,i),n.fill(),n.fillStyle=c[1],n.lineWidth=1,n.strokeStyle="#ffffff",n.beginPath();for(let e=0;e<o;e++){const x=e/w*s,v=Math.log(256-t[e])/Math.log(256)*i*h;e===0?n.moveTo(x,v):n.lineTo(x,v)}n.lineTo(s+a,i+a),n.lineTo(-a,i+a),n.fill(),n.stroke()},H=function(){n.clearRect(0,0,s,i),z()},C=function(){requestAnimationFrame(C),H()},F=function(){s=window.innerWidth*2,i=window.innerHeight*2,l.width=s,l.height=i,l.style.width=s/2+"px",l.style.height=i/2+"px"};document.addEventListener("click",()=>{g||(g=!0,L())})};export{R as default};
