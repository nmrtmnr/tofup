document.documentElement.style.margin="0";document.documentElement.style.padding="0";document.documentElement.style.height="100%";document.documentElement.style.width="100%";document.body.style.margin="0";document.body.style.padding="0";document.body.style.height="100vh";document.body.style.width="100vw";document.body.style.display="flex";document.body.style.justifyContent="center";document.body.style.alignItems="center";document.body.style.background="#FFF";const k="/assets/image/ascii/flower_01.png";let w=!1;const q=K(k);document.body.addEventListener("click",()=>{w||(w=!0,q(()=>{w=!1},15))});const G=[{src:"flower_01.png",r:80,g:150,b:90},{src:"flower_02.png",r:85,g:160,b:100},{src:"flower_03.png",r:90,g:140,b:70},{src:"flower_04.png",r:200,g:190,b:80},{src:"flower_05.png",r:220,g:160,b:60},{src:"flower_06.png",r:240,g:130,b:50},{src:"flower_07.png",r:255,g:110,b:30},{src:"flower_08.png",r:240,g:70,b:70},{src:"flower_09.png",r:200,g:60,b:120},{src:"flower_10.png",r:170,g:50,b:150},{src:"flower_11.png",r:130,g:60,b:170},{src:"flower_12.png",r:90,g:70,b:180},{src:"flower_13.png",r:60,g:90,b:200},{src:"flower_14.png",r:30,g:100,b:220}];let I=null;function B(c,t){return Math.sqrt(Math.pow(c.r-t.r,2)+Math.pow(c.g-t.g,2)+Math.pow(c.b-t.b,2))}function J(c){return G.reduce((t,i)=>{const d=B(i,c);return d<t.dist?{dist:d,src:i.src}:t},{dist:1/0,src:k}).src}function K(c){let t=!1,i=[],d=0;const u=document.createElement("canvas");u.width=30,u.height=30,u.style.display="none";const f=u.getContext("2d");document.body.appendChild(u);const y=new Image;y.crossOrigin="Anonymous",y.src=c,y.onload=()=>{f.drawImage(y,0,0,30,30),L()};const g=document.createElement("div");g.style.position="relative",g.style.width="300px",g.style.height="300px",document.body.appendChild(g);const n=document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.backgroundImage=`url(${c})`,n.style.backgroundSize="300px 300px",n.style.backgroundPosition="center",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.zIndex="1",g.appendChild(n);const o=document.createElement("div");o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="300px",o.style.height="300px",o.style.zIndex="2",g.appendChild(o);const l=document.createElement("div");l.style.position="absolute",l.style.top="0",l.style.left="0",l.style.width="300px",l.style.height="300px",l.style.zIndex="3",g.appendChild(l);function L(){o.innerHTML="",l.innerHTML="",i=[],d=0;const a=f.getImageData(0,0,30,30).data;for(let m=0;m<30;m++)for(let r=0;r<30;r++){const p=(m*30+r)*4,v=a[p],E=a[p+1],_=a[p+2],T=a[p+3]/255,e=document.createElement("div");e.style.position="absolute",e.style.width="10px",e.style.height="10px",e.style.left=`${r*10}px`,e.style.top=`${m*10}px`,e.style.backgroundColor=`rgba(${v},${E},${_},${T})`,e.style.opacity="0",e.style.transform="scale(0)",e.style.transition="transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55), z-index 0s",e.style.pointerEvents="none",e.style.zIndex="2",o.appendChild(e);const s=document.createElement("div");s.style.position="absolute",s.style.width="10px",s.style.height="10px",s.style.left=`${r*10}px`,s.style.top=`${m*10}px`,s.style.zIndex="4",s.addEventListener("mouseenter",()=>{e.style.zIndex="9999",e.style.transform="scale(4.5)",e.style.opacity="1",I={r:v,g:E,b:_}}),s.addEventListener("mouseleave",()=>{e.style.zIndex,setTimeout(()=>{e.style.transform!=="scale(4.5)"&&(e.style.zIndex="2")},400),e.style.transform=t?"scale(1)":"scale(0)",t||(e.style.opacity="0")}),s.addEventListener("click",O=>{if(O.stopPropagation(),!I)return;const $=`/assets/image/ascii/${J(I)}`;f.clearRect(0,0,30,30),y.onload=()=>{f.drawImage(y,0,0,30,30);const b=f.getImageData(0,0,30,30).data;i.forEach(({el:h},M)=>{const z=M%30,x=(Math.floor(M/30)*30+z)*4,S=b[x],H=b[x+1],R=b[x+2],j=b[x+3]/255;h.style.backgroundColor=`rgba(${S},${H},${R},${j})`,h.style.opacity="0",h.style.transform="scale(0)",setTimeout(()=>{h.style.opacity="1",h.style.transform="scale(1)"},z*30+Math.floor(Math.random()*150))})},y.src=$,n.style.backgroundImage=`url(${$})`}),l.appendChild(s);const A=r*30,F=Math.floor(Math.random()*200),C=A+F;i.push({el:e,delay:C}),d=Math.max(d,C)}}function D(a,m){i.forEach(({el:r,delay:p})=>{setTimeout(()=>{r.style.opacity=a?"1":"0",r.style.transform=a?"scale(1)":"scale(0)"},p)}),setTimeout(m,d+300)}function P(a){D(!t,a),t=!t}return P}
